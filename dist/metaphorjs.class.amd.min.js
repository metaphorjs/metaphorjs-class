define("metaphorjs-class",function(){function v(a){return"string"===typeof a||a===""+a}function C(a){if(null===a||"object"!=typeof a)return!1;a=y(a);return 2<a||-1==a}function D(a){if(a&&void 0!=!a.length&&a!==""+a){for(var g=[],c=-1,b=a.length>>>0;++c!==b;g[c]=a[c]);return g}return a?[a]:[]}function z(a){return"object"==typeof a&&3===y(a)&&!a.nodeType&&a.constructor===Object}function E(a){return!0===a||!1===a}function A(){var a=!1,g=!1,c=D(arguments),b=c.shift(),d,m,f;E(c[c.length-1])&&(a=c.pop());
E(c[c.length-1])&&(g=a,a=c.pop());for(;d=c.shift();)for(m in d)if(d.hasOwnProperty(m)&&void 0!==(f=d[m]))if(g)if(b[m]&&z(b[m])&&z(f))A(b[m],f,a,g);else{if(!0===a||void 0==b[m])z(f)?(b[m]={},A(b[m],f,a,!0)):b[m]=f}else if(!0===a||void 0==b[m])b[m]=f;return b}function u(){}function G(a,g){var c=function(){};c.prototype=a.prototype;c=new c;a=a.apply(c,g);return C(a)||!1===a?a:c}function H(a,g,c,b,d,m){d=d||"before";return function(){if("instead"==d)return g.apply(c||b,arguments);if("before"==d){var f=
g.apply(c||b,arguments);var h=!1!==f?a.apply(b||c,arguments):null}else h=a.apply(b||c,arguments),f=g.apply(c||b,arguments);return m?f:h}}var I=Object.prototype.toString,y=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(g){if(!g){if(null===g)return 6;if(void 0===g)return 7}var c=a[I.call(g)];return void 0===c?-1:1===c&&isNaN(g)?8:c}}(),x={plugin:{},mixin:{},
lib:{}},J=x.lib.Cache=function(){var a,g=function(c){var b={},d=[];0==arguments.length&&(c=!0);return{addFinder:function(a,b,h){d[h?"unshift":"push"]({fn:a,context:b})},add:function(d,a,h){if(b[d]&&!1===b[d].rewritable)return b[d];b[d]={rewritable:"undefined"!=typeof h?h:c,value:a};return a},get:function(a,f){if(!b[a]){if(d.length){var m;var c=0;for(m=d.length;c<m;c++){var k=d[c].fn.call(d[c].context,a,this);if(void 0!==k)return this.add(a,k,!0)}}return void 0!==f?this.add(a,f):void 0}return b[a].value},
remove:function(a){var d=b[a];d&&!0===d.rewritable&&delete b[a];return d?d.value:void 0},exists:function(a){return!!b[a]},eachEntry:function(a,d){for(var c in b)a.call(d,b[c].value,c)},clear:function(){b={}},$destroy:function(){this===a&&(a=null);this.remove=this.exists=this.destroy=this.get=this.add=c=b=null}}};g.global=function(){a||(a=new g(!0));return a};return g}(),B=x.lib.Namespace=function(a){a=a||{};var g=new J(!1),c=function(b,d){var c=g.get(b);if(void 0!==c||d)return c;d=b.split(".");var f=
d.length,h=a;for(c=0;c<f;c++){var r=d[c];if(void 0===h[r])return;h=h[r]}h&&g.add(b,h);return h};this.register=function(b,d){var c=b.split("."),f=c.pop();var h=c.join(".");var r=c.length,k=a;if(g[h])b=[g[h],f,b];else{if(0<r)for(h=0;h<r;h++){var n=c[h];void 0===k[n]&&(k[n]={});k=k[n]}b=[k,f,b]}c=b[0];f=b[1];C(c)&&void 0===c[f]&&(c[f]=d,g.add(b[2],d));return d};this.exists=function(a){return void 0!==c(F,!0)};this.get=c;this.add=function(a,d){return g.add(a,d)};this.remove=function(a){return g.remove(a)};
this.makeAlias=function(a,d){a=g.get(a);void 0!==a&&g.add(d,a);return a};this.$destroy=function(){var a;g.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});g.$destroy();g=null;for(a in this)this[a]=null}},K=function(){var a=function(){this.$super&&this.$super!==u&&this.$super.apply(this,arguments)},g=function(a,c,b){var $super=a.prototype[c]||("$constructor"===c?a:u)||u;return function(){var a=this.$super;if(this.$destroyed)return this.$super=null;this.$super=$super;var k=b.apply(this,arguments);
this.$super=a;return k}},c=function(a,c,b,h){var d,k=b.prototype;for(d in c)if(c.hasOwnProperty(d)){var n=k[d];var f=c[d];a[d]="function"!=typeof f||n&&"function"!=typeof n?f:g(b,d,f)}h||(a.$plugins=null,a.$pluginMap=null,k.$beforeInit?(a.$beforeInit=k.$beforeInit.slice(),a.$afterInit=k.$afterInit.slice(),a.$beforeDestroy=k.$beforeDestroy.slice(),a.$afterDestroy=k.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},b=function(d){d||(d=new B);var g=function(a){return function(){var k=
[],c=[],b=arguments,e,f;if(!this)throw Error("Must instantiate via new: "+a);this.$plugins=[];(e=this.$constructor.apply(this,arguments))&&"object"===typeof e&&5===y(e)&&(b=e);var g=this.$plugins;var h=this.$pluginMap={};e=-1;for(f=this.$beforeInit.length;++e<f;k.push([this.$beforeInit[e],this]));e=-1;for(f=this.$afterInit.length;++e<f;c.push([this.$afterInit[e],this]));if(g&&g.length)for(e=0,f=g.length;e<f;e++){var l=g[e];if(v(l)){var m=l;l=d?d.get(l,!0):null;if(!l)throw m+" not found";}l=new l(this,
b);h[l.$class]=l;l.$beforeHostInit&&k.push([l.$beforeHostInit,l]);l.$afterHostInit&&c.push([l.$afterHostInit,l]);g[e]=l}e=-1;for(f=k.length;++e<f;k[e][0].apply(k[e][1],b));this.$init&&this.$init.apply(this,b);e=-1;for(f=c.length;++e<f;c[e][0].apply(c[e][1],b));}},f=function(){};A(f.prototype,{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$destroying:!1,$constructor:u,$init:u,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},
$is:function(a){return r(this,a)},$getParentClass:function(){return this.$extends},$intercept:function(a,c,d,b,e){var k=this[a];this[a]=H(k||u,c,d||this,this,b,e);return k||u},$implement:function(a){var k=this.constructor;k&&k.$parent&&c(this,a,k.$parent,!0)},$hasPlugin:function(a){return a?!!this.$pluginMap[a]:!1},$getPlugin:function(a){return a?this.$pluginMap[a]||null:null},$bind:function(a){var k=this;return function(){if(!k.$isDestroyed())return a.apply(k,arguments)}},$isDestroyed:function(){return self.$destroying||
self.$destroyed},$destroy:function(){var a=this.$beforeDestroy,c=this.$afterDestroy,d=this.$plugins,b;if(!this.$destroying&&!this.$destroyed){this.$destroying=!0;var e=-1;for(b=a.length;++e<b;a[e].apply(this,arguments));e=0;for(b=d.length;e<b;e++)d[e].$beforeHostDestroy&&d[e].$beforeHostDestroy.call(d[e],arguments);a=this.onDestroy.apply(this,arguments);e=-1;for(b=c.length;++e<b;c[e].apply(this,arguments));e=0;for(b=d.length;e<b;e++)d[e].$destroy.apply(d[e],arguments);if(!1!==a)for(e in this)this.hasOwnProperty(e)&&
(this[e]=null);this.$destroying=!1;this.$destroyed=!0}},onDestroy:function(){}});f.$self=f;f.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return G(this,a)}};f.$override=function(a){var d=this.$self,b=this.$parent;d&&b&&c(d.prototype,a,b)};f.$extend=function(a,c){return h(a,c,this)};f.$destroy=function(){for(var a in this)this[a]=
null};var h=function(b,h,m){b=b||{};var k=b.$class,e=m||b.$extends,n=b.$mixins;m=b.$alias;var r,p;if(e)if(v(e))var l=d.get(e);else l=e,e=l.$class||"";else l=f,e="";if(e&&!l)throw e+" not found";b.$class=k;b.$extends=e;b.$mixins=null;e=Object.create(l.prototype);b.$constructor=b.$constructor||a;c(e,b,l);if(n)for(b=0,r=n.length;b<r;b++){var t=n[b];if(v(t)){if(!d)throw Error("Mixin "+t+" not found");t=d.get(t,!0)}var q=void 0,w=e;for(q in t)t.hasOwnProperty(q)&&("$beforeInit"===q?w.$beforeInit.push(t[q]):
"$afterInit"===q?w.$afterInit.push(t[q]):"$beforeDestroy"===q?w.$beforeDestroy.push(t[q]):"$afterDestroy"===q?w.$afterDestroy.push(t[q]):w[q]||(w[q]=t[q]))}n=g(k);e.constructor=n;e.$self=n;n.prototype=e;for(p in f)"prototype"!==p&&f.hasOwnProperty(p)&&(n[p]=f[p]);for(p in l)"prototype"!==p&&l.hasOwnProperty(p)&&(n[p]=l[p]);if(h)for(p in h)"prototype"!==p&&h.hasOwnProperty(p)&&(n[p]=h[p]);n.$parent=l;n.$self=n;d&&(k&&d.register(k,n),m&&d.register(m,n));return n},r=function(a,b){return(b=v(b)&&d?d.get(b):
b)?a instanceof b:!1};h.classManagerFactory=b;h.factory=function(a){var b=d?d.get(a):null,c=D(arguments).slice(1);if(!b)throw a+" not found";return b.$instantiate.apply(b,c)};h.isSubclassOf=function(a,b){var c=a,f=d?d.get:function(){};v(b)||(b=b.prototype.$class);for(v(a)&&(c=f(a));c&&c.prototype;){if(c.prototype.$class===b)return!0;c=c.$parent}return!1};h.isInstanceOf=r;h.define=h;h.Namespace=B;h.BaseClass=f;h.ns=d;h.$destroy=function(){f.$destroy();f=null;d&&(d.$destroy(),d=null)};return h};return b}(),
F=function(){var a=new B;a.register("MetaphorJs",x);a.register("mjs",x);return a}();return K(F)});
