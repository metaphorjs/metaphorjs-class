define("metaphorjs-class",function(){function v(b){return"string"===typeof b||b===""+b}function A(b){if(null===b||"object"!=typeof b)return!1;b=w(b);return 2<b||-1==b}function x(b){return"object"==typeof b&&3===w(b)&&!b.nodeType&&b.constructor===Object}function B(b){return!0===b||!1===b}function p(){}function F(b,f,g,d,a,k){a=a||"before";return function(){if("instead"==a)return f.apply(g||d,arguments);if("before"==a){var h=f.apply(g||d,arguments);var c=!1!==h?b.apply(d||g,arguments):null}else c=b.apply(d||
g,arguments),h=f.apply(g||d,arguments);return k?h:c}}var G=Object.prototype.toString,w=function(){var b={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(f){if(!f){if(null===f)return 6;if(void 0===f)return 7}var g=b[G.call(f)];return void 0===g?-1:1===g&&isNaN(f)?8:g}}(),y={plugin:{},mixin:{}},H=function(){var b,f=function(g){var d={},a=[];0==arguments.length&&(g=!0);return{addFinder:function(k,
d,c){a[c?"unshift":"push"]({fn:k,context:d})},add:function(a,h,c){if(d[a]&&!1===d[a].rewritable)return d[a];d[a]={rewritable:"undefined"!=typeof c?c:g,value:h};return h},get:function(k){if(d[k])return d[k].value;if(a.length){var h;var c=0;for(h=a.length;c<h;c++){var b=a[c].fn.call(a[c].context,k,this);if(void 0!==b)return this.add(k,b,!0)}}},remove:function(a){var b=d[a];b&&!0===b.rewritable&&delete d[a];return b?b.value:void 0},exists:function(a){return!!d[a]},eachEntry:function(a,b){for(var c in d)a.call(b,
d[c].value,c)},$destroy:function(){this===b&&(b=null);this.remove=this.exists=this.destroy=this.get=this.add=g=d=null}}};f.global=function(){b||(b=new f(!0));return b};return f}(),z=y.Namespace=function(b){b=b||{};var f=new H(!1),g=function(d,a){var k=f.get(d,!0);if(void 0!==k||a)return k;a=d.split(".");var h=a.length,c=b;for(k=0;k<h;k++){var g=a[k];if(void 0===c[g])return;c=c[g]}c&&f.add(d,c);return c};this.register=function(d,a){var k=d.split("."),h=k.pop();var c=k.join(".");var g=k.length,l=b;
if(f[c])d=[f[c],h,d];else{if(0<g)for(c=0;c<g;c++){var m=k[c];void 0===l[m]&&(l[m]={});l=l[m]}d=[l,h,d]}k=d[0];h=d[1];A(k)&&void 0===k[h]&&(k[h]=a,f.add(d[2],a));return a};this.exists=function(b){return void 0!==g(C,!0)};this.get=g;this.add=function(b,a){return f.add(b,a)};this.remove=function(b){return f.remove(b)};this.makeAlias=function(b,a){b=f.get(b);void 0!==b&&f.add(a,b);return b};this.$destroy=function(){var b;f.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});f.$destroy();f=null;for(b in this)this[b]=
null}},D=Array.prototype.slice,I=function(){return function f(){var g=!1,d=!1,a=D.call(arguments),k=a.shift(),h,c,u;B(a[a.length-1])&&(g=a.pop());B(a[a.length-1])&&(d=g,g=a.pop());for(;a.length;)if((h=a.shift())&&h.hasOwnProperty)for(c in h)if(h.hasOwnProperty(c)&&void 0!==(u=h[c]))if(d)if(k[c]&&x(k[c])&&x(u))f(k[c],u,g,d);else{if(!0===g||void 0==k[c])x(u)?(k[c]={},f(k[c],u,g,!0)):k[c]=u}else if(!0===g||void 0==k[c])k[c]=u;return k}}(),J=function(b,f){var g=function(){};g.prototype=b.prototype;g=
new g;b=b.apply(g,f);return A(b)||!1===b?b:g},K=function(){var b=function(){this.$super&&this.$super!==p&&this.$super.apply(this,arguments)},f=function(a,b,h){var $super=a.prototype[b]||("$constructor"===b?a:p)||p;return function(){var a=this.$super;if(this.$destroyed)return this.$super=null;this.$super=$super;var l=h.apply(this,arguments);this.$super=a;return l}},g=function(a,b,h,c){var g,l=h.prototype;for(g in b)if(b.hasOwnProperty(g)){var m=l[g];var d=b[g];a[g]="function"!=typeof d||m&&"function"!=
typeof m?d:f(h,g,d)}c||(a.$plugins=null,a.$pluginMap=null,l.$beforeInit?(a.$beforeInit=l.$beforeInit.slice(),a.$afterInit=l.$afterInit.slice(),a.$beforeDestroy=l.$beforeDestroy.slice(),a.$afterDestroy=l.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},d=function(a){a||(a=new z);var k=function(l){return function(){var b=[],c=[],g=arguments,e,d;if(!this)throw"Must instantiate via new: "+l;this.$plugins=[];(e=this.$constructor.apply(this,arguments))&&
"object"===typeof e&&5===w(e)&&(g=e);var h=this.$plugins;var k=this.$pluginMap={};e=-1;for(d=this.$beforeInit.length;++e<d;b.push([this.$beforeInit[e],this]));e=-1;for(d=this.$afterInit.length;++e<d;c.push([this.$afterInit[e],this]));if(h&&h.length)for(e=0,d=h.length;e<d;e++){var f=h[e];if(v(f)){var q=f;f=a?a.get(f,!0):null;if(!f)throw q+" not found";}f=new f(this,g);k[f.$class]=f;f.$beforeHostInit&&b.push([f.$beforeHostInit,f]);f.$afterHostInit&&c.push([f.$afterHostInit,f]);h[e]=f}e=-1;for(d=b.length;++e<
d;b[e][0].apply(b[e][1],g));this.$init&&this.$init.apply(this,g);e=-1;for(d=c.length;++e<d;c[e][0].apply(c[e][1],g));}},h=function(){};I(h.prototype,{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$destroying:!1,$constructor:p,$init:p,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$is:function(a){return f(this,a)},$getParentClass:function(){return this.$extends},$intercept:function(a,b,c,d,e){var l=this[a];
this[a]=F(l||p,b,c||this,this,d,e);return l||p},$implement:function(a){var b=this.constructor;b&&b.$parent&&g(this,a,b.$parent,!0)},$hasPlugin:function(a){return a?!!this.$pluginMap[a]:!1},$getPlugin:function(a){return a?this.$pluginMap[a]||null:null},$bind:function(a){var b=this;return function(){if(!b.$isDestroyed())return a.apply(b,arguments)}},$isDestroyed:function(){return self.$destroying||self.$destroyed},$destroy:function(){var a=this.$beforeDestroy,b=this.$afterDestroy,c=this.$plugins,d;
if(!this.$destroying&&!this.$destroyed){this.$destroying=!0;var e=-1;for(d=a.length;++e<d;a[e].apply(this,arguments));e=0;for(d=c.length;e<d;e++)c[e].$beforeHostDestroy&&c[e].$beforeHostDestroy.call(c[e],arguments);a=this.onDestroy.apply(this,arguments);e=-1;for(d=b.length;++e<d;b[e].apply(this,arguments));e=0;for(d=c.length;e<d;e++)c[e].$destroy.apply(c[e],arguments);if(!1!==a)for(e in this)this.hasOwnProperty(e)&&(this[e]=null);this.$destroying=!1;this.$destroyed=!0}},onDestroy:function(){}});h.$self=
h;h.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return J(this,a)}};h.$override=function(a){var b=this.$self,c=this.$parent;b&&c&&g(b.prototype,a,c)};h.$extend=function(a,b){return c(a,b,this)};h.$destroy=function(){for(var a in this)this[a]=null};var c=function(c,d,f){c=c||{};var l=c.$class,e=f||c.$extends,m=c.$mixins;
f=c.$alias;var E,n;if(e)if(v(e))var t=a.get(e);else t=e,e=t.$class||"";else t=h,e="";if(e&&!t)throw e+" not found";c.$class=l;c.$extends=e;c.$mixins=null;e=Object.create(t.prototype);c.$constructor=c.$constructor||b;g(e,c,t);if(m)for(c=0,E=m.length;c<E;c++){var q=m[c];if(v(q)){if(!a)throw"Mixin "+q+" not found";q=a.get(q,!0)}var r=void 0,p=e;for(r in q)q.hasOwnProperty(r)&&("$beforeInit"===r?p.$beforeInit.push(q[r]):"$afterInit"===r?p.$afterInit.push(q[r]):"$beforeDestroy"===r?p.$beforeDestroy.push(q[r]):
"$afterDestroy"===r?p.$afterDestroy.push(q[r]):p[r]||(p[r]=q[r]))}m=k(l);e.constructor=m;e.$self=m;m.prototype=e;for(n in h)"prototype"!==n&&h.hasOwnProperty(n)&&(m[n]=h[n]);for(n in t)"prototype"!==n&&t.hasOwnProperty(n)&&(m[n]=t[n]);if(d)for(n in d)"prototype"!==n&&d.hasOwnProperty(n)&&(m[n]=d[n]);m.$parent=t;m.$self=m;a&&(l&&a.register(l,m),f&&a.register(f,m));return m},f=function(b,c){return(c=v(c)&&a?a.get(c):c)?b instanceof c:!1};c.classManagerFactory=d;c.factory=function(b){var c=a?a.get(b):
null,d=D.call(arguments,1);if(!c)throw b+" not found";return c.$instantiate.apply(c,d)};c.isSubclassOf=function(b,c){var d=b,f=a?a.get:function(){};v(c)||(c=c.prototype.$class);for(v(b)&&(d=f(b));d&&d.prototype;){if(d.prototype.$class===c)return!0;d=d.$parent}return!1};c.isInstanceOf=f;c.define=c;c.Namespace=z;c.BaseClass=h;c.ns=a;c.$destroy=function(){h.$destroy();h=null;a&&(a.$destroy(),a=null)};return c};return d}(),C=function(){var b=new z;b.register("MetaphorJs",y);b.register("mjs",y);return b}();
return K(C)});
